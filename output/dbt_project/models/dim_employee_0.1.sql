-- Migrated Job: dim_employee_0.1
WITH 
tDBInput_1 AS ( 
    SELECT 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.BUSINESSENTITYID, 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.ADDRESSID, 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.ADDRESSTYPEID, 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.MODIFIEDDATE, 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.ETLLOADID, 
  AW2017NEU_PERSON.BUSINESSENTITYADDRESS.ETLLOADDATE
FROM AW2017NEU_PERSON.BUSINESSENTITYADDRESS 
),
tDBInput_3 AS ( 
    SELECT 
  AW2017NEU_PERSON.ADDRESS.ADDRESSID, 
  AW2017NEU_PERSON.ADDRESS.ADDRESSLINE1, 
  AW2017NEU_PERSON.ADDRESS.ADDRESSLINE2, 
  AW2017NEU_PERSON.ADDRESS.CITY, 
  AW2017NEU_PERSON.ADDRESS.STATEPROVINCEID, 
  AW2017NEU_PERSON.ADDRESS.POSTALCODE, 
  AW2017NEU_PERSON.ADDRESS.MODIFIEDDATE, 
  AW2017NEU_PERSON.ADDRESS.ETLLOADID, 
  AW2017NEU_PERSON.ADDRESS.ETLLOADDATE
FROM AW2017NEU_PERSON.ADDRESS 
),
tDBInput_4 AS ( 
    SELECT 
  AW2017NEU_PERSON.ADDRESSTYPE.ADDRESSTYPEID, 
  AW2017NEU_PERSON.ADDRESSTYPE.ADDRESSTYPENAME, 
  AW2017NEU_PERSON.ADDRESSTYPE.MODIFIEDDATE, 
  AW2017NEU_PERSON.ADDRESSTYPE.ETLLOADID, 
  AW2017NEU_PERSON.ADDRESSTYPE.ETLLOADDATE
FROM AW2017NEU_PERSON.ADDRESSTYPE 
),
tDBInput_5 AS ( 
    SELECT 
  AW2017NEU_PERSON.PERSON.BUSINESSENTITYID, 
  AW2017NEU_PERSON.PERSON.PERSONTYPE, 
  AW2017NEU_PERSON.PERSON.TITLE, 
  AW2017NEU_PERSON.PERSON.FIRSTNAME, 
  AW2017NEU_PERSON.PERSON.MIDDLENAME, 
  AW2017NEU_PERSON.PERSON.LASTNAME, 
  AW2017NEU_PERSON.PERSON.SUFFIX, 
  AW2017NEU_PERSON.PERSON.EMAILPROMOTION, 
  AW2017NEU_PERSON.PERSON.MODIFIEDDATE, 
  AW2017NEU_PERSON.PERSON.ETLLOADID, 
  AW2017NEU_PERSON.PERSON.ETLLOADDATE
FROM AW2017NEU_PERSON.PERSON 
),
tDBInput_6 AS ( 
    SELECT 
  AW2017NEU_PERSON.EMAILADDRESS.BUSINESSENTITYID, 
  AW2017NEU_PERSON.EMAILADDRESS.EMAILADDRESSID, 
  AW2017NEU_PERSON.EMAILADDRESS.EMAILADDRESS, 
  AW2017NEU_PERSON.EMAILADDRESS.MODIFIEDDATE, 
  AW2017NEU_PERSON.EMAILADDRESS.ETLLOADID, 
  AW2017NEU_PERSON.EMAILADDRESS.ETLLOADDATE
FROM AW2017NEU_PERSON.EMAILADDRESS 
),
tDBInput_7 AS ( 
    SELECT 
  AW2017NEU_PERSON.PERSONPHONE.BUSINESSENTITYID, 
  AW2017NEU_PERSON.PERSONPHONE.PHONENUMBER, 
  AW2017NEU_PERSON.PERSONPHONE.PHONENUMBERTYPEID, 
  AW2017NEU_PERSON.PERSONPHONE.MODIFIEDDATE, 
  AW2017NEU_PERSON.PERSONPHONE.ETLLOADID, 
  AW2017NEU_PERSON.PERSONPHONE.ETLLOADDATE
FROM AW2017NEU_PERSON.PERSONPHONE 
),
tDBInput_8 AS ( 
    SELECT 
  AW2017NEU_PERSON.PHONENUMBERTYPE.PHONENUMBERTYPEID, 
  AW2017NEU_PERSON.PHONENUMBERTYPE.PHONENUMBERTYPENAME, 
  AW2017NEU_PERSON.PHONENUMBERTYPE.MODIFIEDDATE, 
  AW2017NEU_PERSON.PHONENUMBERTYPE.ETLLOADID, 
  AW2017NEU_PERSON.PHONENUMBERTYPE.ETLLOADDATE
FROM AW2017NEU_PERSON.PHONENUMBERTYPE 
),
tDBInput_9 AS ( 
    SELECT 
  AW2017NEU_HR.EMPLOYEE.BUSINESSENTITYID, 
  AW2017NEU_HR.EMPLOYEE.NATIONALIDNUMBER, 
  AW2017NEU_HR.EMPLOYEE.LOGINID, 
  AW2017NEU_HR.EMPLOYEE.JOBTITLE, 
  AW2017NEU_HR.EMPLOYEE.BIRTHDATE, 
  AW2017NEU_HR.EMPLOYEE.MARITALSTATUS, 
  AW2017NEU_HR.EMPLOYEE.GENDER, 
  AW2017NEU_HR.EMPLOYEE.HIREDATE, 
  AW2017NEU_HR.EMPLOYEE.SALARIEDFLAG, 
  AW2017NEU_HR.EMPLOYEE.VACATIONHOURS, 
  AW2017NEU_HR.EMPLOYEE.SICKLEAVEHOURS, 
  AW2017NEU_HR.EMPLOYEE.CURRENTFLAG, 
  AW2017NEU_HR.EMPLOYEE.MODIFIEDDATE, 
  AW2017NEU_HR.EMPLOYEE.ETLLOADID, 
  AW2017NEU_HR.EMPLOYEE.ETLLOADDATE
FROM AW2017NEU_HR.EMPLOYEE 
),
tDBInput_10 AS ( 
    SELECT 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.BUSINESSENTITYID, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.DEPARTMENTID, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.SHIFTID, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.STARTDATE, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.ENDDATE, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.MODIFIEDDATE, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.ETLLOADID, 
  AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY.ETLLOADDATE
FROM AW2017NEU_HR.EMPLOYEEDEPARTMENTHISTORY 
),
tDBInput_11 AS ( 
    SELECT 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.BUSINESSENTITYID, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.RATECHANGEDATE, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.RATE, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.PAYFREQUENCY, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.MODIFIEDDATE, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.ETLLOADID, 
  AW2017NEU_HR.EMPLOYEEPAYHISTORY.ETLLOADDATE
FROM AW2017NEU_HR.EMPLOYEEPAYHISTORY 
),
tDBInput_12 AS ( 
    SELECT 
  `purchaseorderheader`.`PurchaseOrderID`, 
  `purchaseorderheader`.`RevisionNumber`, 
  `purchaseorderheader`.`OrderStatus`, 
  `purchaseorderheader`.`EmployeeID`, 
  `purchaseorderheader`.`VendorID`, 
  `purchaseorderheader`.`ShipMethodID`, 
  `purchaseorderheader`.`OrderDate`, 
  `purchaseorderheader`.`ShipDate`, 
  `purchaseorderheader`.`SubTotal`, 
  `purchaseorderheader`.`TaxAmt`, 
  `purchaseorderheader`.`Freight`, 
  `purchaseorderheader`.`TotalDue`, 
  `purchaseorderheader`.`ModifiedDate`, 
  `purchaseorderheader`.`ETLLoadID`, 
  `purchaseorderheader`.`ETLLoadDate`
FROM `purchaseorderheader` 
),
tDBInput_2 AS ( 
    SELECT 
  AW2017NEU_HR.DEPARTMENT.DEPARTMENTID, 
  AW2017NEU_HR.DEPARTMENT.DEPARTMENTNAME, 
  AW2017NEU_HR.DEPARTMENT.GROUPNAME, 
  AW2017NEU_HR.DEPARTMENT.MODIFIEDDATE, 
  AW2017NEU_HR.DEPARTMENT.ETLLOADID, 
  AW2017NEU_HR.DEPARTMENT.ETLLOADDATE
FROM AW2017NEU_HR.DEPARTMENT 
),
tDBInput_13 AS ( 
    SELECT 
  `dimgeography`.`GeoSK`, 
  `dimgeography`.`City`, 
  `dimgeography`.`StateProvinceCode`, 
  `dimgeography`.`StateProvinceName`, 
  `dimgeography`.`IsOnlyStateProvinceFlag`, 
  `dimgeography`.`CountryRegionCode`, 
  `dimgeography`.`CountryRegionName`, 
  `dimgeography`.`PostalCode`, 
  `dimgeography`.`SalesTerritorySK`, 
  `dimgeography`.`SOR_ID`, 
  `dimgeography`.`SOR_LoadDate`, 
  `dimgeography`.`SOR_UpdateDate`, 
  `dimgeography`.`DI_Tool`, 
  `dimgeography`.`DI_Job_ID`, 
  `dimgeography`.`DI_Create_Date`, 
  `dimgeography`.`DI_Modified_Date`
FROM `dimgeography` 
),
tMap_1 AS (
 WITH tDBInput_1 AS (SELECT * FROM businessEntityAddress), tDBInput_2 AS (SELECT * FROM department), tDBInput_3 AS (SELECT * FROM address), tDBInput_4 AS (SELECT * FROM addressType), tDBInput_5 AS (SELECT * FROM person), tDBInput_6 AS (SELECT * FROM emailAddress), tDBInput_7 AS (SELECT * FROM personPhone), tDBInput_8 AS (SELECT * FROM phoneNumberType), tDBInput_9 AS (SELECT * FROM employee), tDBInput_10 AS (SELECT * FROM employeeDepartmentHistory), tDBInput_11 AS (SELECT * FROM employeePayHistory), tDBInput_12 AS (SELECT * FROM purchaseOrderHeader), tDBInput_13 AS (SELECT * FROM geography) SELECT tDBInput_1.BUSINESSENTITYID AS BusinessEntityID, row_number() OVER () AS EmployeeKey, tDBInput_9.NATIONALIDNUMBER AS EmployeeNationalID, tDBInput_3.ADDRESSLINE1 AS AddressLine1, tDBInput_3.ADDRESSLINE2 AS AddressLine2, tDBInput_5.FIRSTNAME AS FirstName, tDBInput_5.LASTNAME AS LastName, tDBInput_5.MIDDLENAME AS MiddleName, tDBInput_9.HIREDATE AS HireDate, tDBInput_9.BIRTHDATE AS BirthDate, tDBInput_6.EMAILADDRESS AS EmailAddress, tDBInput_7.PHONENUMBER AS Phone, tDBInput_9.SALARIEDFLAG AS SalariedFlag, tDBInput_9.GENDER AS Gender, tDBInput_13.DI_Job_ID AS DI_JOB_ID, tDBInput_13.DI_Modified_Date AS DI_MODIFIED_DATE, current_date AS DI_CREATED_DATE, tDBInput_13.GeoSK AS Geokey, 1 AS SOR_ID FROM tDBInput_1 LEFT JOIN tDBInput_3 ON tDBInput_3.ADDRESSID = tDBInput_1.ADDRESSID LEFT JOIN tDBInput_4 ON tDBInput_4.ADDRESSTYPEID = tDBInput_1.ADDRESSTYPEID LEFT JOIN tDBInput_5 ON tDBInput_5.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_6 ON tDBInput_6.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_7 ON tDBInput_7.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_8 ON tDBInput_8.PHONENUMBERTYPEID = tDBInput_7.PHONENUMBERTYPEID LEFT JOIN tDBInput_9 ON tDBInput_9.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_10 ON tDBInput_10.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_11 ON tDBInput_11.BUSINESSENTITYID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_12 ON tDBInput_12.EmployeeID = tDBInput_1.BUSINESSENTITYID LEFT JOIN tDBInput_2 ON tDBInput_2.DEPARTMENTID = tDBInput_10.DEPARTMENTID LEFT JOIN tDBInput_13 ON tDBInput_13.PostalCode = tDBInput_3.POSTALCODE 
),
final_cte AS ( SELECT * FROM tMap_1 )

SELECT * FROM final_cte